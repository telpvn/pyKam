# Функции в Python: Основы

## 1. Конструкция функции

```python
def имя_функции(список_аргументов):
    """Документация функции (необязательно)"""
    # тело функции
    операторы
    return результат  # необязательно
```

### Пример простой функции

```python
def приветствие(имя):
    """Функция для приветствия пользователя"""
    сообщение = f"Привет, {имя}!"
    return сообщение

# Вызов функции
результат = приветствие("Анна")
print(результат)  # Привет, Анна!
```

## 2. Позиционные (неименованные) параметры

Параметры передаются в том порядке, в котором они определены в функции.

```python
def вычислить(a, b, c):
    результат = a + b * c
    return результат

# Вызов с позиционными аргументами
ответ = вычислить(1, 2, 3)  # a=1, b=2, c=3
print(ответ)  # 7

# Порядок важен!
ответ2 = вычислить(3, 2, 1)  # a=3, b=2, c=1
print(ответ2)  # 5
```

### Пример с разными типами данных

```python
def создать_профиль(имя, возраст, город):
    профиль = f"{имя}, {возраст} лет, живет в {город}"
    return профиль

пользователь = создать_профиль("Иван", 25, "Москва")
print(пользователь)  # Иван, 25 лет, живет в Москва
```

## 3. Параметры по умолчанию (дефолтные)

Можно задать значения по умолчанию для параметров.

```python
def поздороваться(имя, приветствие="Привет"):
    return f"{приветствие}, {имя}!"

# Использование значения по умолчанию
print(поздороваться("Мария"))  # Привет, Мария!

# Переопределение значения по умолчанию
print(поздороваться("Петр", "Добро пожаловать"))  # Добро пожаловать, Петр!
```

### Важно: мутабельные объекты по умолчанию

```python
# ❌ Неправильно - опасно!
def добавить_элемент(элемент, список=[]):
    список.append(элемент)
    return список

# ✅ Правильно
def добавить_элемент(элемент, список=None):
    if список is None:
        список = []
    список.append(элемент)
    return список

# Пример использования
новый_список = добавить_элемент("первый")
print(новый_список)  # ['первый']
```

### Множественные параметры по умолчанию

```python
def настроить_сервер(хост="localhost", порт=8000, отладка=False):
    конфиг = f"Сервер: {хост}:{порт}, отладка: {отладка}"
    return конфиг

# Разные способы вызова
print(настроить_сервер())  # localhost:8000, отладка: False
print(настроить_сервер("192.168.1.1"))  # 192.168.1.1:8000, отладка: False
print(настроить_сервер("localhost", 3000))  # localhost:3000, отладка: False
print(настроить_сервер("localhost", 3000, True))  # localhost:3000, отладка: True
```

## 4. Именованные параметры

Можно передавать аргументы по имени, независимо от порядка.

```python
def создать_отчет(заголовок, содержание, автор="Неизвестен"):
    отчет = f"""
    Отчет: {заголовок}
    Автор: {автор}
    Содержание: {содержание}
    """
    return отчет

# Именованные аргументы (порядок не важен)
отчет1 = создать_отчет(
    содержание="Анализ продаж за месяц",
    заголовок="Месячный отчет",
    автор="Аналитик Иванов"
)

# Смешивание позиционных и именованных
отчет2 = создать_отчет(
    "Квартальный отчет",  # позиционный
    содержание="Финансовые показатели",  # именованный
    автор="Бухгалтер Петрова"  # именованный
)

print(отчет1)
print(отчет2)
```

### Принудительно именованные параметры

```python
def рассчитать_стоимость(базовая_цена, *, налог=0.2, скидка=0):
    """* означает, что все параметры после него должны быть именованными"""
    итоговая_цена = базовая_цена * (1 + налог) * (1 - скидка)
    return итоговая_цена

# Правильно
цена = рассчитать_стоимость(1000, налог=0.18, скидка=0.1)
print(цена)  # 1062.0

# ❌ Это вызовет ошибку:
# цена = рассчитать_стоимость(1000, 0.18, 0.1)
```

## 5. Оператор return

`return` завершает выполнение функции и возвращает значение.

```python
def проверить_возраст(возраст):
    if возраст >= 18:
        return "Совершеннолетний"
    else:
        return "Несовершеннолетний"

статус = проверить_возраст(20)
print(статус)  # Совершеннолетний
```

### Множественные return

```python
def найти_максимум(числа):
    if not числа:
        return None  # Ранний выход
    
    максимум = числа[0]
    for число in числа[1:]:
        if число > максимум:
            максимум = число
    
    return максимум

результат = найти_максимум([3, 7, 2, 9, 1])
print(результат)  # 9
```

### Возвращение нескольких значений

```python
def статистика(числа):
    if not числа:
        return None, None, None
    
    минимум = min(числа)
    максимум = max(числа)
    среднее = sum(числа) / len(числа)
    
    return минимум, максимум, среднее

# Распаковка результата
мин, макс, сред = статистика([1, 2, 3, 4, 5])
print(f"Мин: {мин}, Макс: {макс}, Среднее: {сред}")  # Мин: 1, Макс: 5, Среднее: 3.0
```

## 6. Функции как объекты первого класса

В Python функции можно передавать как аргументы и присваивать переменным.

```python
def сложение(a, b):
    return a + b

def умножение(a, b):
    return a * b

def применить_операцию(x, y, операция):
    """Применяет переданную функцию к двум числам"""
    результат = операция(x, y)
    return результат

# Передача функции как аргумента
результат1 = применить_операцию(5, 3, сложение)
результат2 = применить_операцию(5, 3, умножение)

print(результат1)  # 8
print(результат2)  # 15
```

### Присваивание функций переменным

```python
def приветствие():
    return "Привет!"

# Присваиваем функцию переменной
моя_функция = приветствие

# Теперь можно вызывать через переменную
print(моя_функция())  # Привет!

# Функция и переменная ссылаются на один объект
print(приветствие is моя_функция)  # True
```

### Список функций

```python
def квадрат(x):
    return x ** 2

def куб(x):
    return x ** 3

def корень(x):
    return x ** 0.5

# Создаем список функций
математические_функции = [квадрат, куб, корень]

число = 4
for функция in математические_функции:
    результат = функция(число)
    имя_функции = функция.__name__
    print(f"{имя_функции}({число}) = {результат}")

# Вывод:
# квадрат(4) = 16
# куб(4) = 64
# корень(4) = 2.0
```

## Практические примеры

### Калькулятор с функциями

```python
def калькулятор(a, b, операция="+"):
    """Простой калькулятор"""
    if операция == "+":
        return a + b
    elif операция == "-":
        return a - b
    elif операция == "*":
        return a * b
    elif операция == "/":
        if b != 0:
            return a / b
        else:
            return "Ошибка: деление на ноль"
    else:
        return "Неизвестная операция"

# Примеры использования
print(калькулятор(10, 5))        # 15 (сложение по умолчанию)
print(калькулятор(10, 5, "-"))   # 5
print(калькулятор(10, 5, "*"))   # 50
print(калькулятор(10, 5, "/"))   # 2.0
```

### Валидация данных

```python
def проверить_email(email, строгая_проверка=False):
    """Проверяет корректность email адреса"""
    if not email or "@" not in email:
        return False
    
    if строгая_проверка:
        # Более строгая проверка
        части = email.split("@")
        if len(части) != 2:
            return False
        локальная, домен = части
        if not локальная or not домен or "." not in домен:
            return False
    
    return True

# Тестирование
emails = ["test@example.com", "invalid-email", "user@domain", ""]

for email in emails:
    базовая = проверить_email(email)
    строгая = проверить_email(email, строгая_проверка=True)
    print(f"{email}: базовая={базовая}, строгая={строгая}")
```

## 7. Переопределение функций

В Python функции можно переопределять как переменные. Новое определение заменяет предыдущее.

```python
def приветствие():
    return "Обычное приветствие"

print(приветствие())  # Обычное приветствие

# Переопределяем функцию
def приветствие():
    return "Новое приветствие!"

print(приветствие())  # Новое приветствие!
```

### Условное переопределение функций

```python
import random

def получить_приветствие():
    return "Привет!"

# Переопределяем функцию в зависимости от условия
if random.choice([True, False]):
    def получить_приветствие():
        return "Добро пожаловать!"

print(получить_приветствие())  # Либо "Привет!", либо "Добро пожаловать!"
```

### Сохранение оригинальной функции

```python
def оригинальная_функция(x):
    return x * 2

# Сохраняем ссылку на оригинальную функцию
старая_функция = оригинальная_функция

# Переопределяем
def оригинальная_функция(x):
    результат = старая_функция(x)  # Вызываем старую версию
    return результат + 1  # Добавляем новую логику

print(оригинальная_функция(5))  # 11 (5*2 + 1)
```

### Переопределение в зависимости от контекста

```python
def настроить_логирование(режим_отладки=False):
    if режим_отладки:
        def лог(сообщение):
            print(f"[DEBUG] {сообщение}")
    else:
        def лог(сообщение):
            pass  # Ничего не делаем в обычном режиме
    
    return лог

# Создаем разные версии функции логирования
лог_отладки = настроить_логирование(True)
лог_продакшн = настроить_логирование(False)

лог_отладки("Тестовое сообщение")  # [DEBUG] Тестовое сообщение
лог_продакшн("Тестовое сообщение")  # Ничего не выводит
```

## 8. Документация функций (Docstrings)

Документация - это строки в тройных кавычках сразу после определения функции.

### Основные форматы документации

```python
def простая_функция(x):
    """Это простая документация функции."""
    return x * 2

def подробная_функция(имя, возраст, активен=True):
    """
    Создает профиль пользователя.
    
    Args:
        имя (str): Имя пользователя
        возраст (int): Возраст пользователя
        активен (bool): Статус активности пользователя
    
    Returns:
        dict: Словарь с информацией о пользователе
    
    Raises:
        ValueError: Если возраст отрицательный
    
    Example:
        >>> профиль = подробная_функция("Анна", 25)
        >>> print(профиль['имя'])
        Анна
    """
    if возраст < 0:
        raise ValueError("Возраст не может быть отрицательным")
    
    return {
        'имя': имя,
        'возраст': возраст,
        'активен': активен
    }
```

### Google Style docstrings

```python
def обработать_данные(данные, формат='json', сжатие=False):
    """Обрабатывает входные данные в указанном формате.

    Функция принимает данные любого типа и преобразует их в указанный
    формат с возможностью сжатия.

    Args:
        данные: Входные данные для обработки
        формат (str): Формат вывода ('json', 'xml', 'csv')
        сжатие (bool): Применять ли сжатие к результату

    Returns:
        str: Обработанные данные в указанном формате

    Raises:
        ValueError: Если указан неподдерживаемый формат
        TypeError: Если данные нельзя сериализовать

    Note:
        Функция поддерживает только базовые типы данных Python.

    Example:
        >>> результат = обработать_данные({'ключ': 'значение'})
        >>> print(результат)
        {"ключ": "значение"}
    """
    поддерживаемые_форматы = ['json', 'xml', 'csv']
    
    if формат not in поддерживаемые_форматы:
        raise ValueError(f"Неподдерживаемый формат: {формат}")
    
    # Логика обработки данных
    if формат == 'json':
        import json
        результат = json.dumps(данные, ensure_ascii=False)
    else:
        результат = str(данные)
    
    if сжатие:
        # Имитация сжатия
        результат = f"[COMPRESSED] {результат}"
    
    return результат
```

### NumPy Style docstrings

```python
def математическая_операция(a, b, операция='add'):
    """
    Выполняет математическую операцию над двумя числами.

    Parameters
    ----------
    a : float
        Первое число
    b : float
        Второе число
    операция : str, optional
        Тип операции ('add', 'subtract', 'multiply', 'divide')
        По умолчанию 'add'

    Returns
    -------
    float
        Результат математической операции

    Raises
    ------
    ValueError
        Если указана неизвестная операция
    ZeroDivisionError
        Если происходит деление на ноль

    Examples
    --------
    >>> математическая_операция(5, 3)
    8.0
    >>> математическая_операция(10, 2, 'divide')
    5.0
    """
    if операция == 'add':
        return float(a + b)
    elif операция == 'subtract':
        return float(a - b)
    elif операция == 'multiply':
        return float(a * b)
    elif операция == 'divide':
        if b == 0:
            raise ZeroDivisionError("Деление на ноль невозможно")
        return float(a / b)
    else:
        raise ValueError(f"Неизвестная операция: {операция}")
```

## 9. Функция help() и получение документации

Функция `help()` позволяет получить документацию любого объекта Python.

### Основное использование help()

```python
def моя_функция(x, y=10):
    """
    Умножает x на y и возвращает результат.
    
    Args:
        x: Первое число
        y: Второе число (по умолчанию 10)
    
    Returns:
        Произведение x и y
    """
    return x * y

# Получаем справку о функции
help(моя_функция)

# Вывод:
# Help on function моя_функция in module __main__:
# 
# моя_функция(x, y=10)
#     Умножает x на y и возвращает результат.
#     
#     Args:
#         x: Первое число
#         y: Второе число (по умолчанию 10)
#     
#     Returns:
#         Произведение x и y
```

### Альтернативные способы получения документации

```python
def документированная_функция():
    """Это пример функции с документацией."""
    pass

# Способ 1: help()
help(документированная_функция)

# Способ 2: атрибут __doc__
print(документированная_функция.__doc__)

# Способ 3: встроенные функции
print("Имя функции:", документированная_функция.__name__)
print("Модуль:", документированная_функция.__module__)
```

### Справка по встроенным функциям

```python
# Справка по встроенным функциям Python
help(len)
help(print)
help(range)

# Справка по методам строк
help(str.split)
help(str.replace)

# Справка по модулям
import math
help(math)
help(math.sqrt)
```

### Создание интерактивной справки

```python
def система_справки():
    """Интерактивная система справки для пользовательских функций."""
    
    функции_справки = {
        'калькулятор': """
        Функция калькулятор(a, b, операция='+')
        
        Выполняет базовые математические операции.
        
        Параметры:
            a, b - числа для операции
            операция - тип операции ('+', '-', '*', '/')
        
        Пример: калькулятор(10, 5, '*') -> 50
        """,
        
        'приветствие': """
        Функция приветствие(имя, формальное=False)
        
        Генерирует приветственное сообщение.
        
        Параметры:
            имя - имя для приветствия
            формальное - использовать формальный стиль
        
        Пример: приветствие('Анна') -> 'Привет, Анна!'
        """
    }
    
    def показать_справку(функция=None):
        if функция is None:
            print("Доступные функции:", list(функции_справки.keys()))
        elif функция in функции_справки:
            print(функции_справки[функция])
        else:
            print(f"Справка для '{функция}' не найдена")
    
    return показать_справку

# Использование
справка = система_справки()
справка()  # Показывает список функций
справка('калькулятор')  # Показывает справку по калькулятору
```

## Основные принципы

1. **Одна функция - одна задача**: функция должна решать конкретную задачу
2. **Понятные имена**: название функции должно отражать её назначение
3. **Документация**: добавляйте docstring для всех публичных функций
4. **Возврат значений**: функция должна возвращать результат, а не только печатать
5. **Избегайте глобальных переменных**: передавайте данные через параметры
6. **Переопределение с осторожностью**: сохраняйте ссылки на оригинальные функции при необходимости

```python
def хорошая_функция(данные, настройка=True):
    """
    Обрабатывает данные согласно настройке.
    
    Args:
        данные: входные данные для обработки
        настройка: флаг включения дополнительной обработки
    
    Returns:
        обработанные данные
    
    Example:
        >>> результат = хорошая_функция([1, 2, 3])
        >>> print(результат)
        [1, 2, 3]
    """
    результат = данные.copy() if hasattr(данные, 'copy') else данные
    
    if настройка:
        # дополнительная обработка
        pass
    
    return результат

# Проверяем документацию
help(хорошая_функция)
```